{"version":3,"file":"index.js","sources":["../src/pixabay-api.js","../src/render-gallery.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '50804443-2b846a940781baef8affcab62';\nconst BASE_URL = 'https://pixabay.com/api/';\nlet currentPage = 1;\nlet searchQuery = '';\n\nexport async function fetchImages(query) {\n  if (query !== searchQuery) {\n    currentPage = 1;\n    searchQuery = query;\n  }\n\n  const params = {\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 40,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n  currentPage += 1;\n\n  return response.data;\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nlet lightbox = null;\n\nexport function renderGallery(images) {\n  const markup = images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <a class=\"photo-card\" href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          <div class=\"info\">\n            <p><b>Likes:</b> ${likes}</p>\n            <p><b>Views:</b> ${views}</p>\n            <p><b>Comments:</b> ${comments}</p>\n            <p><b>Downloads:</b> ${downloads}</p>\n          </div>\n        </a>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n","import './css/styles.css';\nimport { fetchImages, resetPage } from './pixabay-api.js';\nimport { renderGallery, clearGallery } from './render-gallery.js';\n\nconst form = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader');\n\nlet currentQuery = '';\nlet totalHits = 0;\nlet loadedImages = 0;\n\nform.addEventListener('submit', async (e) => {\n  e.preventDefault();\n  const query = e.currentTarget.elements.searchQuery.value.trim();\n\n  if (!query) return;\n\n  clearGallery();\n  loadMoreBtn.classList.add('hidden');\n  showLoader();\n\n  try {\n    resetPage();\n    currentQuery = query;\n    const data = await fetchImages(query);\n    totalHits = data.totalHits;\n    loadedImages = data.hits.length;\n\n    renderGallery(data.hits);\n    if (loadedImages < totalHits) {\n      loadMoreBtn.classList.remove('hidden');\n    }\n\n  } catch (error) {\n    console.error(error);\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  showLoader();\n  try {\n    const data = await fetchImages(currentQuery);\n    renderGallery(data.hits);\n\n    loadedImages += data.hits.length;\n    scrollPage();\n\n    if (loadedImages >= totalHits) {\n      loadMoreBtn.classList.add('hidden');\n      alert(\"We're sorry, but you've reached the end of search results.\");\n    }\n\n  } catch (error) {\n    console.error(error);\n  } finally {\n    hideLoader();\n  }\n});\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction scrollPage() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery a')\n    .getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","currentPage","searchQuery","fetchImages","query","params","response","axios","resetPage","gallery","lightbox","renderGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","form","loadMoreBtn","loader","currentQuery","totalHits","loadedImages","e","showLoader","data","error","hideLoader","scrollPage","cardHeight"],"mappings":"iyBAEA,MAAMA,EAAU,qCACVC,EAAW,2BACjB,IAAIC,EAAc,EACdC,EAAc,GAEX,eAAeC,EAAYC,EAAO,CACnCA,IAAUF,IACZD,EAAc,EACdC,EAAcE,GAGhB,MAAMC,EAAS,CACb,IAAKN,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMD,EACN,SAAU,EACd,EAEQK,EAAW,MAAMC,EAAM,IAAIP,EAAU,CAAE,OAAAK,CAAM,CAAE,EACrD,OAAAJ,GAAe,EAERK,EAAS,IAClB,CAEO,SAASE,GAAY,CAC1BP,EAAc,CAChB,CC5BA,MAAMQ,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAAW,KAER,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EACZ,IACC,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA,sCAC9CL,CAAa;AAAA,sBAC7BD,CAAY,UAAUE,CAAI;AAAA;AAAA,+BAEjBC,CAAK;AAAA,+BACLC,CAAK;AAAA,kCACFC,CAAQ;AAAA,mCACPC,CAAS;AAAA;AAAA;AAAA,OAIvC,EACA,KAAK,EAAE,EAEVX,EAAQ,mBAAmB,YAAaI,CAAM,EAEzCH,EAGHA,EAAS,QAAO,EAFhBA,EAAW,IAAIW,EAAe,YAAY,CAI9C,CAEO,SAASC,GAAe,CAC7Bb,EAAQ,UAAY,EACtB,CC9BA,MAAMc,EAAO,SAAS,cAAc,cAAc,EAClC,SAAS,cAAc,UAAU,EACjD,MAAMC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EAAe,GACfC,EAAY,EACZC,EAAe,EAEnBL,EAAK,iBAAiB,SAAU,MAAOM,GAAM,CAC3CA,EAAE,eAAc,EAChB,MAAMzB,EAAQyB,EAAE,cAAc,SAAS,YAAY,MAAM,OAEzD,GAAKzB,EAEL,CAAAkB,IACAE,EAAY,UAAU,IAAI,QAAQ,EAClCM,IAEA,GAAI,CACFtB,IACAkB,EAAetB,EACf,MAAM2B,EAAO,MAAM5B,EAAYC,CAAK,EACpCuB,EAAYI,EAAK,UACjBH,EAAeG,EAAK,KAAK,OAEzBpB,EAAcoB,EAAK,IAAI,EACnBH,EAAeD,GACjBH,EAAY,UAAU,OAAO,QAAQ,CAGxC,OAAQQ,EAAO,CACd,QAAQ,MAAMA,CAAK,CACvB,QAAY,CACRC,GACD,EACH,CAAC,EAEDT,EAAY,iBAAiB,QAAS,SAAY,CAChDM,IACA,GAAI,CACF,MAAMC,EAAO,MAAM5B,EAAYuB,CAAY,EAC3Cf,EAAcoB,EAAK,IAAI,EAEvBH,GAAgBG,EAAK,KAAK,OAC1BG,IAEIN,GAAgBD,IAClBH,EAAY,UAAU,IAAI,QAAQ,EAClC,MAAM,4DAA4D,EAGrE,OAAQQ,EAAO,CACd,QAAQ,MAAMA,CAAK,CACvB,QAAY,CACRC,GACD,CACH,CAAC,EAED,SAASH,GAAa,CACpBL,EAAO,UAAU,OAAO,QAAQ,CAClC,CAEA,SAASQ,GAAa,CACpBR,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAEA,SAASS,GAAa,CACpB,KAAM,CAAE,OAAQC,CAAU,EAAK,SAC5B,cAAc,YAAY,EAC1B,wBAEH,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}